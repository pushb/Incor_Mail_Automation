<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Send Email to Incor Team</title>
    <style>
        /* Modern CSS Reset & Variables */
        :root {
            --primary: #007bff;
            --primary-dark: #0056b3;
            --success: #25D366;
            --success-dark: #1da851;
            --bg: #f8fafc;
            --surface: #ffffff;
            --text: #334155;
            --text-light: #64748b;
            --border: #e2e8f0;
            --radius: 16px;
            --shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --danger: #ef4444;
            --danger-bg: #fef2f2;
            --danger-border: #fecaca;
        }

        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            padding: 20px; 
            background: var(--bg); 
            color: var(--text);
            line-height: 1.5;
            margin: 0;
            min-height: 100vh;
        }

        #container { 
            max-width: 500px; 
            margin: 20px auto 0 auto; 
            background: var(--surface); 
            padding: 30px 24px; 
            border-radius: var(--radius); 
            box-shadow: var(--shadow);
        } 

        /* Typography */
        h1 { margin-top: 0; font-size: 1.6rem; text-align: center; color: #0f172a; margin-bottom: 0.5rem; letter-spacing: -0.025em; }
        .subtitle { text-align: center; color: var(--text-light); font-size: 1rem; margin-bottom: 2.5rem; }

        label { font-weight: 600; display: block; margin-bottom: 8px; font-size: 0.95rem; color: #1e293b; }
        
        /* Main Flat Input */
        input#flat { 
            width: 100%; 
            padding: 14px; 
            font-size: 1.1rem; 
            border-radius: 12px; 
            border: 2px solid #cbd5e1; 
            box-sizing: border-box; 
            transition: all 0.2s;
            outline: none;
            color: #1e293b;
        }
        input#flat:focus { border-color: var(--primary); background: #f0f9ff; }

        /* Buttons */
        .btn {
            width: 100%; padding: 14px; font-size: 1rem; font-weight: 600;
            border: none; border-radius: 12px; cursor: pointer;
            transition: all 0.2s ease;
            display: flex; align-items: center; justify-content: center; gap: 8px;
            text-decoration: none;
            box-sizing: border-box;
        }
        .btn:active { transform: scale(0.98); }

        .btn-primary { background: var(--primary); color: white; margin-top: 12px; }
        .btn-primary:hover { background: var(--primary-dark); }

        /* Action Buttons (Accordion Toggles) */
        .btn-action { 
            margin-top: 20px; 
            justify-content: space-between; 
            padding: 16px;
            font-size: 1.05rem;
            position: relative;
            z-index: 10;
        }
        
        .arrow { transition: transform 0.3s ease; font-size: 0.8em; opacity: 0.7; }
        .rotate { transform: rotate(180deg); }

        /* Sections */
        .section { display: none; opacity: 0; transform: translateY(10px); transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .section.visible { display: block; opacity: 1; transform: translateY(0); }

        /* Nested Content (Subsections) */
        .collapsible-content { 
            display: none; 
            margin-left: 24px; /* Indent */
            padding-left: 20px;
            border-left-width: 3px;
            border-left-style: solid;
            margin-top: 8px;
            animation: slideDown 0.3s ease forwards;
        }

        /* Hierarchy colors */
        #emailSection .collapsible-content { border-left-color: #bfdbfe; }
        #waSection .collapsible-content { border-left-color: #bbf7d0; }

        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        /* Email Inner Styles */
        .email-form-container {
            margin-top: 5px;
        }

        /* Input Cards inside Tree */
        .input-card {
            background: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            padding: 12px 16px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            box-shadow: 0 1px 2px rgba(0,0,0,0.03);
            transition: box-shadow 0.2s;
        }
        .input-card:focus-within { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(0,123,255,0.1); }

        .email-label {
            width: 35px;
            color: #64748b;
            font-weight: 600;
            margin: 0;
            flex-shrink: 0;
            font-size: 0.9rem;
        }

        #emailTo {
            border: none;
            background: transparent;
            padding: 0;
            margin: 0;
            width: 100%;
            outline: none;
            font-size: 0.95rem;
            color: #334155;
            font-weight: 500;
        }
        
        /* CC Section */
        .cc-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            width: 100%;
        }
        .cc-status { color: #334155; font-weight: 500; font-size: 0.95rem; }

        .cc-body { 
            max-height: 0; 
            overflow-y: auto; 
            transition: max-height 0.3s ease; 
            width: 100%;
        }
        .cc-body.open { 
            max-height: 250px; 
            margin-top: 10px; 
            padding-top: 10px; 
            border-top: 1px dashed #e2e8f0; 
        }

        .cc-item {
            display: flex; align-items: center;
            padding: 6px 0;
            cursor: pointer;
            transition: opacity 0.2s;
        }
        .cc-item:hover { opacity: 0.8; }
        .cc-item input { margin-right: 12px; width: 16px; height: 16px; accent-color: var(--primary); cursor: pointer; }
        .cc-name { font-size: 0.9rem; color: #334155; font-weight: 500; }
        .cc-email { font-size: 0.75rem; color: #94a3b8; display: block; margin-top: 1px; }

        /* Inner Action Button (Smaller than main toggle) */
        .btn-sub-action {
            width: 100%;
            padding: 12px;
            font-size: 0.95rem;
            border-radius: 10px;
            margin-top: 8px;
            background: #2563eb;
            color: white;
            box-shadow: 0 2px 5px rgba(37, 99, 235, 0.2);
        }
        .btn-sub-action:hover { background: #1d4ed8; }

        /* WhatsApp Contacts List (Tree Items) */
        .wa-list { margin-top: 10px; display: grid; gap: 8px; }
        .wa-link {
            display: flex;
            background: white;
            border: 1px solid #e2e8f0;
            padding: 12px 16px; /* Compact padding */
            border-radius: 10px;
            text-decoration: none;
            color: #1e293b;
            font-weight: 500;
            font-size: 0.95rem;
            justify-content: space-between; align-items: center;
            transition: all 0.2s;
            box-shadow: 0 1px 2px rgba(0,0,0,0.03);
        }
        .wa-link:hover { 
            border-color: var(--success); 
            background: #f0fdf4; 
            color: var(--success-dark); 
            transform: translateX(4px); /* Slide effect */
        }

        /* Error Styling */
        .error-box {
            background-color: var(--danger-bg);
            border: 1px solid var(--danger-border);
            border-radius: 12px;
            padding: 16px;
            margin-top: 24px;
            display: none;
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
        .error-title { color: var(--danger); font-weight: 700; font-size: 1.1rem; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
        .error-content { color: var(--text); font-size: 0.95rem; line-height: 1.6; }
        .example-box { background: rgba(255,255,255,0.7); padding: 12px; border-radius: 8px; margin-top: 10px; border: 1px solid var(--danger-border); color: #475569; font-size: 0.9rem; }

        /* Feedback Button */
        .feedback-container { 
            margin: 30px auto; 
            text-align: center; 
            max-width: 500px;
        }
        .btn-feedback {
            background: #ffffff;
            border: 1px solid #cbd5e1;
            color: #475569;
            font-weight: 500;
            font-size: 0.9rem;
            padding: 12px 24px;
            border-radius: 30px;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex; align-items: center; gap: 8px;
            transition: all 0.2s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .btn-feedback:hover { 
            background: #fff; 
            color: var(--primary); 
            border-color: var(--primary); 
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.08); 
        }

    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.1/",
    "react/": "https://aistudiocdn.com/react@^19.2.1/"
  }
}
</script>
</head>
<body>

<div id="container">
    <div style="text-align: center; margin-bottom: 10px;">
        <div style="display: inline-flex; justify-content: center; align-items: center; width: 60px; height: 60px; background: #eff6ff; border-radius: 16px; color: var(--primary); margin-bottom: 16px;">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="2" width="16" height="20" rx="2" ry="2"></rect><path d="M9 22v-4h6v4"></path><path d="M8 6h.01"></path><path d="M16 6h.01"></path><path d="M12 6h.01"></path><path d="M12 10h.01"></path><path d="M12 14h.01"></path><path d="M16 10h.01"></path><path d="M16 14h.01"></path><path d="M8 10h.01"></path><path d="M8 14h.01"></path></svg>
        </div>
    </div>
    <h1>Send email to Incor team</h1>
    <p class="subtitle">For your flat status and possession date</p>

    <label for="flat">Enter your flat number</label>
    <div style="position: relative;">
        <input id="flat" type="text" placeholder="e.g., A0203" onkeydown="if(event.key === 'Enter') validateFlat()" />
    </div>
    <button class="btn btn-primary" onclick="validateFlat()">Next ➜</button>

    <!-- Error Box -->
    <div id="errorBox" class="error-box">
        <div class="error-title">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
            <span id="errorTitle">Invalid Format</span>
        </div>
        <div class="error-content" id="errorContent"></div>
    </div>

    <!-- Email Section -->
    <div id="emailSection" class="section">
        <button class="btn btn-action" onclick="toggleSection('emailContent', 'emailArrow')" style="background: #eff6ff; color: var(--primary); border: 1px solid #bfdbfe;">
            <span style="display:flex; align-items:center; gap:10px;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
                Send Inquiry Email
            </span>
            <span id="emailArrow" class="arrow">▼</span>
        </button>

        <!-- Nested Subsection -->
        <div id="emailContent" class="collapsible-content">
            <div class="email-form-container">
                <!-- To Row -->
                <div class="input-card">
                    <label class="email-label">To:</label>
                    <input id="emailTo" type="email" value="ilcsupport@incor.in" />
                </div>

                <!-- CC Row -->
                <div class="input-card" style="flex-direction: column; align-items: flex-start;">
                    <div class="cc-header" onclick="toggleCC()">
                        <div style="display:flex; align-items:center; gap:8px;">
                            <label class="email-label">CC:</label>
                            <span id="ccCount" class="cc-status">Loading...</span>
                        </div>
                        <span id="ccArrow" class="arrow" style="color:#94a3b8;">▼</span>
                    </div>
                    
                    <!-- CC Body -->
                    <div id="ccBody" class="cc-body">
                        <!-- CC Items injected via JS -->
                    </div>
                </div>
            </div>

            <button class="btn btn-sub-action" onclick="sendEmail()">
                Open Mail App
            </button>
        </div>
    </div>

    <!-- WhatsApp Section -->
    <div id="waSection" class="section">
        <button class="btn btn-action" onclick="toggleSection('waContent', 'waArrow')" style="background: #f0fdf4; color: var(--success-dark); border: 1px solid #bbf7d0;">
            <span style="display:flex; align-items:center; gap:10px;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
                Send via WhatsApp
            </span>
            <span id="waArrow" class="arrow">▼</span>
        </button>

        <!-- Nested Subsection -->
        <div id="waContent" class="collapsible-content">
            <div id="waList" class="wa-list">
                <!-- WA Links injected via JS -->
            </div>
        </div>
    </div>
</div>

<!-- Feedback Outside Main Box -->
<div class="feedback-container">
    <a href="#" onclick="sendFeedback(event)" class="btn-feedback">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
        Send feedback or suggestions to developer
    </a>
</div>

<script>
// --- Data ---
const CC_LIST = [
  { email: "enquiries@incorlakecity.com", name: "Enquiries Team" },
  { email: "sanjay.padamatwar@incorlakecity.com", name: "Sanjay Padamatwar" },
  { email: "abdulla.hussain@incorlakecity.com", name: "Abdulla Hussain" },
  { email: "deepika.sripathi@incorlakecity.com", name: "Deepika Sripathi" },
  { email: "swathi.kowlampet@incorlakecity.com", name: "Swathi Kowlampet" },
  { email: "satyanarayana.potukuchi@incorlakecity.com", name: "Satyanarayana Potukuchi" },
  { email: "srikanth.basineni@incorlakecity.com", name: "Srikanth Basineni" },
  { email: "surya@incor.in", name: "Surya" },
  { email: "info@incor.in", name: "Incor Info" },
  { email: "ramesh.vantaram@incor.in", name: "Ramesh Vantaram" },
  { email: "ananth.kalle@incor.in", name: "Ananth Kalle" },
  { email: "prudhvi.chinta@incor.in", name: "Prudhvi Chinta" },
];

const WA_CONTACTS = [
  { name: "Srikanth", phone: "917674996742" },
  { name: "Swati", phone: "9121315034" },
  { name: "Hussain", phone: "8885722631" },
];

const FEEDBACK_PHONE = "918977496236";

// --- Initialization ---
document.addEventListener('DOMContentLoaded', () => {
    renderCCList();
    updateCCCount();
});

function renderCCList() {
    const container = document.getElementById('ccBody');
    let html = '';
    CC_LIST.forEach((cc, index) => {
        html += `
            <label class="cc-item">
                <input type="checkbox" class="cc-checkbox" value="${cc.email}" checked onchange="updateCCCount()">
                <div>
                    <div class="cc-name">${cc.name}</div>
                    <div class="cc-email">${cc.email}</div>
                </div>
            </label>
        `;
    });
    container.innerHTML = html;
}

function updateCCCount() {
    const checked = document.querySelectorAll('.cc-checkbox:checked').length;
    document.getElementById('ccCount').innerText = `${checked} Selected`;
}

// --- Validation ---
function validateFlat() {
    const input = document.getElementById("flat");
    const flat = input.value.trim().toUpperCase();
    const errorBox = document.getElementById("errorBox");
    const emailSection = document.getElementById("emailSection");
    const waSection = document.getElementById("waSection");

    let errorTitle = "";
    let errorMsg = "";

    const exampleBlock = `
        <div class="example-box">
            <b>Examples:</b><br>
            • A0203 (Tower A, Floor 02, House 03)<br>
            • B0107 (Tower B, Floor 01, House 07)
        </div>`;

    if (flat.length !== 5) {
        errorTitle = "Invalid Length";
        errorMsg = "Flat number must be exactly 5 characters." + exampleBlock;
    } else {
        const tower = flat.charAt(0);
        const floor = parseInt(flat.substring(1,3));
        const house = parseInt(flat.substring(3,5));

        if (tower !== "A" && tower !== "B") {
            errorTitle = "Invalid Tower";
            errorMsg = "Tower must be <b>A</b> or <b>B</b>." + exampleBlock;
        } else if (isNaN(floor) || floor < 1 || floor > 23) {
            errorTitle = "Invalid Floor";
            errorMsg = "Floor must be between <b>01</b> and <b>23</b>." + exampleBlock;
        } else if (isNaN(house)) {
            errorTitle = "Invalid House";
            errorMsg = "House number is not valid." + exampleBlock;
        } else {
            if (tower === "A" && (house < 1 || house > 33)) {
                errorTitle = "Invalid House for Tower A";
                errorMsg = "For Tower A, house must be 01-33." + exampleBlock;
            } else if (tower === "B" && (house < 1 || house > 35)) {
                errorTitle = "Invalid House for Tower B";
                errorMsg = "For Tower B, house must be 01-35." + exampleBlock;
            }
        }
    }

    if (errorTitle) {
        document.getElementById("errorTitle").innerText = errorTitle;
        document.getElementById("errorContent").innerHTML = errorMsg;
        errorBox.style.display = "block";
        emailSection.classList.remove("visible");
        waSection.classList.remove("visible");
    } else {
        // Validation Passed
        
        // Reset Logic: Collapse sections to default state
        document.getElementById('emailContent').style.display = 'none';
        document.getElementById('emailArrow').classList.remove('rotate');
        document.getElementById('waContent').style.display = 'none';
        document.getElementById('waArrow').classList.remove('rotate');
        // Close CC dropdown if open
        document.getElementById("ccBody").classList.remove("open");
        document.getElementById("ccArrow").classList.remove("rotate");

        errorBox.style.display = "none";
        emailSection.classList.add("visible");
        waSection.classList.add("visible");
        renderWALinks(flat);
    }
}

// --- Interaction ---
function toggleSection(contentId, arrowId) {
    const content = document.getElementById(contentId);
    const arrow = document.getElementById(arrowId);
    
    if (content.style.display === "block") {
        content.style.display = "none";
        arrow.classList.remove("rotate");
    } else {
        content.style.display = "block";
        arrow.classList.add("rotate");
    }
}

function toggleCC() {
    const body = document.getElementById("ccBody");
    const arrow = document.getElementById("ccArrow");
    body.classList.toggle("open");
    arrow.classList.toggle("rotate");
}

// --- Action Logic ---
function getGreeting() {
    const h = new Date().getHours();
    if (h >= 5 && h <= 11) return "Good morning";
    if (h >= 12 && h <= 16) return "Good afternoon";
    if (h >= 17 && h <= 20) return "Good evening";
    return "Sorry to disturb you at night time";
}

function sendEmail() {
    const flat = document.getElementById("flat").value.trim().toUpperCase();
    const to = document.getElementById("emailTo").value;
    
    // Gather CCs
    const checkedBoxes = document.querySelectorAll('.cc-checkbox:checked');
    const ccList = Array.from(checkedBoxes).map(cb => cb.value).join(',');

    const today = new Date();
    const dd = String(today.getDate()).padStart(2,'0');
    const mm = String(today.getMonth()+1).padStart(2,'0');
    const yyyy = today.getFullYear();
    const dateStr = dd + mm + yyyy;

    const subject = `Request to share progress & expected possession date – Flat ${flat} – Dated ${dateStr}`;
    const body = `Hi Team,

I hereby request you to share the progress and also the expected possession date of our flat i.e ${flat}.

Thanks,
Flat owner of ${flat}`;

    const link = `mailto:${to}?cc=${encodeURIComponent(ccList)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
    window.location.href = link;
}

function renderWALinks(flat) {
    const container = document.getElementById("waList");
    let html = "";
    
    const greeting = getGreeting();
    
    WA_CONTACTS.forEach(contact => {
        const msg = `Hi ${contact.name}, ${greeting}. I own flat number ${flat}, I wish to know the status of my flat as well as expected possession date. Can you please help me with that. Thanks in advance.`;
        const link = `https://wa.me/${contact.phone}?text=${encodeURIComponent(msg)}`;
        
        html += `
            <a href="${link}" class="wa-link" target="_blank">
                <span>Chat with ${contact.name}</span>
                <span style="font-size:1.1rem; color: #cbd5e1;">↗</span>
            </a>
        `;
    });
    
    container.innerHTML = html;
}

function sendFeedback(event) {
    if(event) event.preventDefault();
    const msg = "Hi Pavan, This is regarding webapp to send mail to incor team... I have a suggestion/feedback:";
    const link = `https://wa.me/${FEEDBACK_PHONE}?text=${encodeURIComponent(msg)}`;
    window.open(link, '_blank');
}

</script>
</body>
</html>
